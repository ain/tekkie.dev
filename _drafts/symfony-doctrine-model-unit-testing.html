---
layout: post
title: Symfony Doctrine model unit testing
date: 
type: post
published: false
status: draft
categories:
- Flash
tags: []
meta:
  _edit_last: '1'
author:
  login: ain
  email: ain@flashbit.net
  display_name: Ain Tohvri
  first_name: Ain
  last_name: Tohvri
---
<p>I followed the exact steps at http://www.symfony-project.org/jobeet/1_4/Doctrine/en/08 for the project to create unit tests for a Doctrine model.</p>
<p>1st run of a simplistic unit test succeeds, a 2nd run fails with ` SQLSTATE[23000]: Integrity constraint violation: 1452 Cannot add or update a child row: a foreign key constraint fails... `</p>
<p>It's pretty clear the problem lies in the Doctrine.php given in the tutorial where it loads data on each test:</p>
<p>    Doctrine_Core::loadData(sfConfig::get('sf_test_dir').'/fixtures');</p>
<p>How have you solved it? Do you load fixtures manually?</p>
<p>Related links:<br />
Truncate all tables of a Doctrine Connection https://gist.github.com/1154458</p>
